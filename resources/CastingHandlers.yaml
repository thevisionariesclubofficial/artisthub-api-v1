createJob:
  handler: src/handlers/casting.createJob
  iamRoleStatements:
    - Effect: Allow
      Action:
        - dynamodb:PutItem
      Resource: !GetAtt CastingTable.Arn
  events:
    - httpApi:
        path: /casting
        method: post
        cors: true

getJobById:
  handler: src/handlers/casting.getJobById
  iamRoleStatements:
    - Effect: Allow
      Action:
        - dynamodb:GetItem
      Resource: !GetAtt CastingTable.Arn
  events:
    - httpApi:
        path: /casting/{jobId}
        method: get
        cors: true

listJobs:
  handler: src/handlers/casting.listJobs
  iamRoleStatements:
    - Effect: Allow
      Action:
        - dynamodb:Scan
      Resource: !GetAtt CastingTable.Arn
  events:
    - httpApi:
        path: /casting
        method: get
        cors: true

updateJob:
  handler: src/handlers/casting.updateJob
  iamRoleStatements:
    - Effect: Allow
      Action:
        - dynamodb:UpdateItem
        - dynamodb:GetItem
      Resource: !GetAtt CastingTable.Arn
  events:
    - httpApi:
        path: /casting/{jobId}
        method: put
        cors: true

deleteJob:
  handler: src/handlers/casting.deleteJob
  iamRoleStatements:
    - Effect: Allow
      Action:
        - dynamodb:DeleteItem
        - dynamodb:GetItem
      Resource: !GetAtt CastingTable.Arn
  events:
    - httpApi:
        path: /casting/{jobId}
        method: delete
        cors: true

applyForJob:
  handler: src/handlers/casting.applyForJob
  iamRoleStatements:
    - Effect: Allow
      Action:
        - dynamodb:UpdateItem
        - dynamodb:GetItem
      Resource: !GetAtt CastingTable.Arn
  events:
    - httpApi:
        path: /casting/{jobId}/apply
        method: post
        cors: true

getJobApplications:
  handler: src/handlers/casting.getJobApplications
  iamRoleStatements:
    - Effect: Allow
      Action:
        - dynamodb:GetItem
      Resource: !GetAtt CastingTable.Arn
  events:
    - httpApi:
        path: /casting/{jobId}/applications
        method: get
        cors: true

updateApplicationStatus:
  handler: src/handlers/casting.updateApplicationStatus
  iamRoleStatements:
    - Effect: Allow
      Action:
        - dynamodb:UpdateItem
        - dynamodb:GetItem
      Resource: !GetAtt CastingTable.Arn
  events:
    - httpApi:
        path: /casting/{jobId}/applications/{userId}
        method: put
        cors: true

incrementJobView:
  handler: src/handlers/casting.incrementJobView
  iamRoleStatements:
    - Effect: Allow
      Action:
        - dynamodb:UpdateItem
      Resource: !GetAtt CastingTable.Arn
  events:
    - httpApi:
        path: /casting/{jobId}/view
        method: put
        cors: true

addDocument:
  handler: src/handlers/casting.addDocument
  iamRoleStatements:
    - Effect: Allow
      Action:
        - dynamodb:UpdateItem
        - dynamodb:GetItem
      Resource: !GetAtt CastingTable.Arn
  events:
    - httpApi:
        path: /casting/{jobId}/documents
        method: post
        cors: true

removeDocument:
  handler: src/handlers/casting.removeDocument
  iamRoleStatements:
    - Effect: Allow
      Action:
        - dynamodb:UpdateItem
        - dynamodb:GetItem
      Resource: !GetAtt CastingTable.Arn
  events:
    - httpApi:
        path: /casting/{jobId}/documents/{docId}
        method: delete
        cors: true

getUserApplications:
  handler: src/handlers/casting.getUserApplications
  iamRoleStatements:
    - Effect: Allow
      Action:
        - dynamodb:Scan
      Resource: !GetAtt CastingTable.Arn
  events:
    - httpApi:
        path: /casting/user/{userId}/applications
        method: get
        cors: true

searchJobs:
  handler: src/handlers/casting.searchJobs
  iamRoleStatements:
    - Effect: Allow
      Action:
        - dynamodb:Scan
      Resource: !GetAtt CastingTable.Arn
  events:
    - httpApi:
        path: /casting/search
        method: get
        cors: true
